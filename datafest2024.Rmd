# load data
```{r}
setwd("~/Desktop/DATAFEST2024 DATA/Full Data")
page_views <- read.csv("page_views.csv")
eoc <- read.csv("checkpoints_eoc.csv")
pulse <- read.csv("checkpoints_pulse.csv")
```

# load packages
```{r}
library(dplyr)
library(tidyr)
library(ggplot2)
library(factoextra)
```

# page views
```{r}
page_views$book <- as.factor(page_views$book)
page_views$chapter_number <- as.factor(page_views$chapter_number)
page_views$institution_id <- as.factor(page_views$institution_id)
page_views$class_id <- as.factor(page_views$class_id)
page_views$student_id <- as.factor(page_views$student_id)

str(page_views)
```

# eoc
```{r}
eoc$book <- as.factor(eoc$book)
eoc$class_id <- as.factor(eoc$class_id)
eoc$chapter_number <- as.factor(eoc$chapter_number)
```


# pulse
```{r}

pulse1 <- pulse_ABCD %>% 
  na.omit() %>% 
  pivot_wider(names_from = construct, values_from = response, id_cols = c(chapter_number, student_id))

pulse1 <- pulse1 %>% 
  na.omit() %>% 
  group_by(student_id) %>% 
  summarise(Cost = mean(Cost),
            Expectancy = mean(Expectancy),
            `Intrinsic Value` = mean(`Intrinsic Value`),
            `Utility Value` = mean(`Utility Value`))
```

# Pulse Clustering!!!
```{r}
#scaled_pulse <- scale(c(pulse1$Cost, pulse1$Expectancy, pulse1$`Intrinsic Value`, pulse1$`Utility Value`))

pulse1noStudent <- pulse1 %>% 
    select(-student_id)

fviz_nbclust(pulse1noStudent, kmeans, method="wss")
fviz_nbclust(pulse1noStudent, kmeans, method="silhouette")
fviz_nbclust(pulse1noStudent, kmeans, method="gap_stat")

pulse1noStudent_kmeans_result <- kmeans(na.omit(pulse1noStudent), centers = 2, iter.max=100, nstart=100)
print(pulse1noStudent_kmeans_result)
pulse1noStudent_cluster_assignments <- pulse1noStudent_kmeans_result$cluster
fviz_cluster(data=pulse1noStudent, kmeans(na.omit(pulse1noStudent), centers = 2, iter.max=100, nstart=100))


```

# EOC and Pulse Correlation
```{r}



```




